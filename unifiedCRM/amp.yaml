# unifiedCRM/amp.yaml
# Unified CRM API - Compatible with merge.dev's common model
# Key difference: You control what fields to include, not limited by lowest common denominator

specVersion: 1.0.0
integrations:
  # ============= SALESFORCE =============
  - name: salesforce_unified
    displayName: Salesforce (Unified CRM)
    provider: salesforce
    read:
      objects:
        # Account → Unified "company" object
        - objectName: Account
          mapToName: company
          destination: crmWebhook
          schedule: "*/15 * * * *"
          requiredFields:
            # Core fields that exist across all CRMs
            - fieldName: Id
              mapToName: id
            - fieldName: Name
              mapToName: name
            - fieldName: Website
              mapToName: website
            - fieldName: Industry
              mapToName: industry
            - fieldName: NumberOfEmployees
              mapToName: employee_count
            - fieldName: OwnerId
              mapToName: owner_id
            # Salesforce-specific fields
            - fieldName: Type
            - fieldName: AccountNumber
            - fieldName: AnnualRevenue

        # Contact → Unified "person" object
        - objectName: Contact
          mapToName: person
          destination: crmWebhook
          schedule: "*/15 * * * *"
          requiredFields:
            - fieldName: Id
              mapToName: id
            - fieldName: FirstName
              mapToName: first_name
            - fieldName: LastName
              mapToName: last_name
            - fieldName: Email
              mapToName: email
            - fieldName: AccountId
              mapToName: company_id
            - fieldName: OwnerId
              mapToName: owner_id
            # Salesforce-specific
            - fieldName: LeadSource

        # Opportunity → Unified "deal" object
        - objectName: Opportunity
          mapToName: deal
          destination: crmWebhook
          schedule: "*/15 * * * *"
          requiredFields:
            - fieldName: Id
              mapToName: id
            - fieldName: Name
              mapToName: name
            - fieldName: Amount
              mapToName: value
            - fieldName: StageName
              mapToName: stage
            - fieldName: CloseDate
              mapToName: expected_close
            - fieldName: AccountId
              mapToName: company_id
            - fieldName: OwnerId
              mapToName: owner_id

    write:
      objects:
        - objectName: Account
          inheritMapping: true
        - objectName: Contact
          inheritMapping: true
        - objectName: Opportunity
          inheritMapping: true

  # ============= HUBSPOT =============
  - name: hubspot_unified
    displayName: HubSpot (Unified CRM)
    provider: hubspot
    module: crm
    read:
      objects:
        # Company → Unified "company" object
        - objectName: companies
          mapToName: company
          destination: crmWebhook
          schedule: "*/15 * * * *"
          requiredFields:
            - fieldName: id
              mapToName: id
            - fieldName: name
              mapToName: name
            - fieldName: domain
              mapToName: website
            - fieldName: industry
              mapToName: industry
            - fieldName: numberofemployees
              mapToName: employee_count
            - fieldName: hubspot_owner_id
              mapToName: owner_id
            # HubSpot-specific fields
            - fieldName: lifecyclestage
            - fieldName: hs_lead_status

        # Contact → Unified "person" object
        - objectName: contacts
          mapToName: person
          destination: crmWebhook
          schedule: "*/15 * * * *"
          requiredFields:
            - fieldName: id
              mapToName: id
            - fieldName: firstname
              mapToName: first_name
            - fieldName: lastname
              mapToName: last_name
            - fieldName: email
              mapToName: email
            - fieldName: associatedcompanyid
              mapToName: company_id
            - fieldName: hubspot_owner_id
              mapToName: owner_id
            # HubSpot-specific
            - fieldName: lifecyclestage

        # Deal → Unified "deal" object
        - objectName: deals
          mapToName: deal
          destination: crmWebhook
          schedule: "*/15 * * * *"
          requiredFields:
            - fieldName: id
              mapToName: id
            - fieldName: dealname
              mapToName: name
            - fieldName: amount
              mapToName: value
            - fieldName: dealstage
              mapToName: stage
            - fieldName: closedate
              mapToName: expected_close
            - fieldName: hubspot_owner_id
              mapToName: owner_id

    write:
      objects:
        - objectName: companies
          inheritMapping: true
        - objectName: contacts
          inheritMapping: true
        - objectName: deals
          inheritMapping: true

  # ============= ZOHO CRM =============
  - name: zoho_unified
    displayName: Zoho CRM (Unified CRM)
    provider: zoho
    module: crm
    read:
      objects:
        # Accounts → Unified "company" object
        - objectName: Accounts
          mapToName: company
          destination: crmWebhook
          schedule: "*/15 * * * *"
          requiredFields:
            - fieldName: id
              mapToName: id
            - fieldName: Account_Name
              mapToName: name
            - fieldName: Website
              mapToName: website
            - fieldName: Industry
              mapToName: industry
            - fieldName: Employees
              mapToName: employee_count
            - fieldName: Owner
              mapToName: owner_id

        # Contacts → Unified "person" object
        - objectName: Contacts
          mapToName: person
          destination: crmWebhook
          schedule: "*/15 * * * *"
          requiredFields:
            - fieldName: id
              mapToName: id
            - fieldName: First_Name
              mapToName: first_name
            - fieldName: Last_Name
              mapToName: last_name
            - fieldName: Email
              mapToName: email
            - fieldName: Account_Name
              mapToName: company_id
            - fieldName: Owner
              mapToName: owner_id

        # Deals → Unified "deal" object
        - objectName: Deals
          mapToName: deal
          destination: crmWebhook
          schedule: "*/15 * * * *"
          requiredFields:
            - fieldName: id
              mapToName: id
            - fieldName: Deal_Name
              mapToName: name
            - fieldName: Amount
              mapToName: value
            - fieldName: Stage
              mapToName: stage
            - fieldName: Closing_Date
              mapToName: expected_close
            - fieldName: Account_Name
              mapToName: company_id
            - fieldName: Owner
              mapToName: owner_id

    write:
      objects:
        - objectName: Accounts
          inheritMapping: true
        - objectName: Contacts
          inheritMapping: true
        - objectName: Deals
          inheritMapping: true

  # ============= DYNAMICS 365 =============
  - name: dynamics_unified
    displayName: Dynamics 365 (Unified CRM)
    provider: dynamicsCRM
    read:
      objects:
        # accounts → Unified "company" object
        - objectName: accounts
          mapToName: company
          destination: crmWebhook
          schedule: "*/15 * * * *"
          requiredFields:
            - fieldName: accountid
              mapToName: id
            - fieldName: name
              mapToName: name
            - fieldName: websiteurl
              mapToName: website
            - fieldName: industrycode
              mapToName: industry
            - fieldName: numberofemployees
              mapToName: employee_count
            - fieldName: ownerid
              mapToName: owner_id

        # contacts → Unified "person" object
        - objectName: contacts
          mapToName: person
          destination: crmWebhook
          schedule: "*/15 * * * *"
          requiredFields:
            - fieldName: contactid
              mapToName: id
            - fieldName: firstname
              mapToName: first_name
            - fieldName: lastname
              mapToName: last_name
            - fieldName: emailaddress1
              mapToName: email
            - fieldName: parentcustomerid
              mapToName: company_id
            - fieldName: ownerid
              mapToName: owner_id

        # opportunities → Unified "deal" object
        - objectName: opportunities
          mapToName: deal
          destination: crmWebhook
          schedule: "*/15 * * * *"
          requiredFields:
            - fieldName: opportunityid
              mapToName: id
            - fieldName: name
              mapToName: name
            - fieldName: estimatedvalue
              mapToName: value
            - fieldName: salesstagecode
              mapToName: stage
            - fieldName: estimatedclosedate
              mapToName: expected_close
            - fieldName: customerid
              mapToName: company_id
            - fieldName: ownerid
              mapToName: owner_id

    write:
      objects:
        - objectName: accounts
          inheritMapping: true
        - objectName: contacts
          inheritMapping: true
        - objectName: opportunities
          inheritMapping: true
